# Como Executar o Projeto

Este guia explica como configurar e executar o projeto de testes E2E localmente.

## Pr√©-requisitos

Antes de come√ßar, certifique-se de ter instalado:

- **Node.js** (vers√£o 18 ou superior)
- **npm** ou **yarn** (gerenciador de pacotes)
- **Git** (para clonar o reposit√≥rio)

## Configura√ß√£o por Sistema Operacional

### macOS

#### Instala√ß√£o do Node.js

**Op√ß√£o 1: Usando Homebrew (recomendado)**
```bash
# Instalar Homebrew (se ainda n√£o tiver)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# Instalar Node.js
brew install node
```

**Op√ß√£o 2: Download direto**
- Acesse [nodejs.org](https://nodejs.org/) e baixe o instalador para macOS
- Execute o instalador e siga as instru√ß√µes

#### Verificar instala√ß√£o
```bash
node --version
npm --version
```

#### Instala√ß√£o do Playwright
Ap√≥s instalar as depend√™ncias do projeto, instale os browsers:
```bash
npm install
npx playwright install
```

**Nota para macOS:** O Playwright pode solicitar permiss√µes de acessibilidade. Se necess√°rio, v√° em:
- **Configura√ß√µes do Sistema** ‚Üí **Privacidade e Seguran√ßa** ‚Üí **Acessibilidade**
- Adicione o Terminal ou seu editor de c√≥digo

### Linux

#### Instala√ß√£o do Node.js

**Ubuntu/Debian:**
```bash
# Atualizar pacotes
sudo apt update

# Instalar Node.js e npm
sudo apt install nodejs npm

# Ou instalar vers√£o mais recente via NodeSource
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs
```

**Fedora/RHEL/CentOS:**
```bash
# Instalar Node.js e npm
sudo dnf install nodejs npm

# Ou via NodeSource
curl -fsSL https://rpm.nodesource.com/setup_20.x | sudo bash -
sudo dnf install -y nodejs
```

**Arch Linux:**
```bash
sudo pacman -S nodejs npm
```

#### Depend√™ncias do sistema para Playwright

O Playwright requer algumas depend√™ncias do sistema. Instale-as antes de executar os testes:

**Ubuntu/Debian:**
```bash
sudo apt-get install -y \
    libnss3 \
    libnspr4 \
    libatk1.0-0 \
    libatk-bridge2.0-0 \
    libcups2 \
    libdrm2 \
    libdbus-1-3 \
    libxkbcommon0 \
    libxcomposite1 \
    libxdamage1 \
    libxfixes3 \
    libxrandr2 \
    libgbm1 \
    libasound2 \
    libpango-1.0-0 \
    libcairo2 \
    libatspi2.0-0 \
    libxshmfence1
```

**Fedora/RHEL/CentOS:**
```bash
sudo dnf install -y \
    nss \
    nspr \
    atk \
    at-spi2-atk \
    cups-libs \
    libdrm \
    libxkbcommon \
    libXcomposite \
    libXdamage \
    libXfixes \
    libXrandr \
    mesa-libgbm \
    alsa-lib \
    pango \
    cairo \
    at-spi2-core \
    libxshmfence
```

#### Instala√ß√£o do Playwright
```bash
npm install
npx playwright install --with-deps
```

O flag `--with-deps` instala automaticamente as depend√™ncias do sistema necess√°rias.

### Windows

#### Instala√ß√£o do Node.js

**Op√ß√£o 1: Download direto (recomendado)**
- Acesse [nodejs.org](https://nodejs.org/)
- Baixe o instalador LTS para Windows
- Execute o instalador e siga as instru√ß√µes
- Certifique-se de marcar a op√ß√£o "Add to PATH" durante a instala√ß√£o

**Op√ß√£o 2: Usando Chocolatey**
```powershell
# Instalar Chocolatey (se ainda n√£o tiver)
# Execute no PowerShell como Administrador:
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# Instalar Node.js
choco install nodejs
```

**Op√ß√£o 3: Usando Winget**
```powershell
winget install OpenJS.NodeJS.LTS
```

#### Verificar instala√ß√£o
Abra o **PowerShell** ou **Prompt de Comando** e execute:
```powershell
node --version
npm --version
```

#### Instala√ß√£o do Playwright
```powershell
npm install
npx playwright install
```

**Nota para Windows:** O Playwright pode solicitar permiss√µes do Windows Defender ou antiv√≠rus durante a instala√ß√£o dos browsers. Permita o acesso se solicitado.

#### PowerShell vs Command Prompt
Os comandos funcionam tanto no PowerShell quanto no Command Prompt (cmd). Se preferir usar Git Bash, tamb√©m funcionar√° normalmente.

## Instala√ß√£o

### 1. Clone o reposit√≥rio

```bash
git clone <repository-url>
cd agibank_e2e_tests
```

### 2. Instale as depend√™ncias

```bash
npm install
```

Este comando instalar√° todas as depend√™ncias do projeto listadas no `package.json`, incluindo:
- `@playwright/test` - Framework de testes
- `typescript` - Compilador TypeScript
- `@types/node` - Tipos TypeScript para Node.js

### 3. Instale os browsers do Playwright

```bash
npx playwright install
```

Este comando baixar√° e instalar√° os browsers necess√°rios para execu√ß√£o dos testes:
- Chromium
- Firefox
- WebKit (Safari)

**Notas por sistema operacional:**

- **macOS:** O comando acima funciona normalmente. Se houver problemas de permiss√£o, o sistema pode solicitar acesso de acessibilidade.
- **Linux:** Use `npx playwright install --with-deps` para instalar automaticamente as depend√™ncias do sistema necess√°rias.
- **Windows:** O comando acima funciona normalmente. O Windows Defender pode solicitar permiss√£o durante a instala√ß√£o dos browsers.

**Se encontrar problemas de permiss√£o ou depend√™ncias do sistema:**

```bash
npx playwright install --with-deps
```

## Executando os Testes Localmente

### Executar todos os testes

```bash
npm test
```

ou

```bash
npx playwright test
```

### Executar testes em modo headed (com interface gr√°fica)

```bash
npm run test:headed
```

√ötil para ver o que est√° acontecendo durante a execu√ß√£o dos testes.

### Executar testes em modo debug

```bash
npm run test:debug
```

Abre o Playwright Inspector para debug interativo dos testes.

### Executar testes com UI mode (interativo)

```bash
npm run test:ui
```

Interface gr√°fica interativa para executar e debugar testes.

### Executar testes em um browser espec√≠fico

```bash
# Apenas Chromium
npm run test:chromium

# Apenas Firefox
npm run test:firefox

# Apenas WebKit (Safari)
npm run test:webkit
```

### Gerar c√≥digo de teste automaticamente

```bash
npm run test:codegen
```

Abre o Playwright Codegen para gerar c√≥digo de teste interativamente enquanto voc√™ navega pelo site.

### Visualizar relat√≥rio de testes

Ap√≥s executar os testes, voc√™ pode visualizar o relat√≥rio HTML:

```bash
npm run test:report
```

O relat√≥rio ser√° aberto automaticamente no navegador, mostrando:
- Resultados dos testes (passou/falhou)
- Screenshots de falhas
- V√≠deos de execu√ß√£o (se configurado)
- Traces para debug

## Estrutura de Resultados

Ap√≥s a execu√ß√£o dos testes, os seguintes diret√≥rios ser√£o criados:

- **`test-results/`**: Cont√©m screenshots, v√≠deos e traces dos testes
- **`playwright-report/`**: Cont√©m o relat√≥rio HTML interativo

## Execu√ß√£o via Docker

Para executar os testes em um ambiente containerizado com Docker, consulte a documenta√ß√£o completa:

üìÑ **[Execu√ß√£o via Docker](./docker-run.MD)**

A documenta√ß√£o de Docker inclui:
- Como construir a imagem Docker
- Como executar testes no Docker
- Como usar docker-compose
- Troubleshooting e solu√ß√µes de problemas comuns
- Comandos para rebuild da imagem

**Vantagens da execu√ß√£o via Docker:**
- Ambiente isolado e consistente
- N√£o requer instala√ß√£o local dos browsers
- F√°cil integra√ß√£o com CI/CD
- Mesmo ambiente em diferentes m√°quinas
